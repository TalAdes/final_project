{"ast":null,"code":"import rsa from \"node-rsa\";\nimport axios from 'axios'; // Mock of an authentication service\n\nvar Auth = {\n  _isAuthenticated: false,\n  authenticate: function authenticate(name, pass, cb) {\n    var data = {\n      name: name,\n      'password': pass\n    };\n    var key = new rsa();\n    fetch('/get_PK_and_random').then(function (response) {\n      return response.json();\n    }).then(function (response) {\n      var pk = response.pk;\n      var rn = response.rn; //encrypting the pass before sending it to the server\n\n      key.importKey(pk, ['public']); //data['password']+rn inorder to prevenr reply attack\n\n      data.password = key.encrypt(data.password + rn, 'base64');\n      console.log(\"data:\");\n      console.log(data);\n      console.log(\"data.password:\");\n      console.log(data.password);\n      return data;\n    }).catch(function (err) {\n      return console.log(\"get_PK_and_random error: \" + err);\n    }).then(function (data) {\n      return fetch('/new_login', {\n        method: 'POST',\n        body: JSON.stringify(data),\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n    }) // .then(res => res.text())\n    // .then(res => console.log(res))\n    .then(function (res) {\n      return res.json();\n    }).then(function (res) {\n      return cb(res);\n    }).catch(function (err) {\n      console.log(err + ';)');\n      cb({\n        'isAuthenticated': false\n      });\n    }); // this._isAuthenticated = true;\n    // setTimeout(\n    //   () =>\n    //     cb({\n    //       name: name\n    //     }),\n    //   100\n    // );\n  },\n  register: function register(name, pass, cb) {\n    var data = {\n      name: name,\n      'password': pass\n    };\n    var key = new rsa();\n    fetch('/get_PK_and_random').then(function (response) {\n      return response.json();\n    }).then(function (response) {\n      var pk = response.pk;\n      var rn = response.rn; //encrypting the pass before sending it to the server\n\n      key.importKey(pk, ['public']); //data['password']+rn inorder to prevenr reply attack\n\n      data.password = key.encrypt(data.password + rn, 'base64');\n      console.log(\"data:\");\n      console.log(data);\n      console.log(\"data.password:\");\n      console.log(data.password);\n      return data;\n    }).catch(function (err) {\n      return console.log(\"get_PK_and_random error: \" + err);\n    }).then(function (data) {\n      return fetch('/new_login', {\n        method: 'POST',\n        body: JSON.stringify(data),\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n    }) // .then(res => res.text())\n    // .then(res => console.log(res))\n    .then(function (res) {\n      return res.json();\n    }).then(function (res) {\n      return cb(res);\n    }).catch(function (err) {\n      console.log(err + ';)');\n      cb({\n        'isAuthenticated': false\n      });\n    }); // this._isAuthenticated = true;\n    // setTimeout(\n    //   () =>\n    //     cb({\n    //       name: name\n    //     }),\n    //   100\n    // );\n  },\n  signout: function signout(cb) {\n    axios.get('logOut').then(function () {\n      return false;\n    }).catch(function (err) {\n      console.log(err);\n      cb('Something went wrong, please try again');\n    }); // this._isAuthenticated = false;\n    // setTimeout(cb, 100);\n  }\n};\nexport default Auth;","map":{"version":3,"sources":["C:/Users/54646/OneDrive - g.jct.ac.il/תוכנה לאינטרנט/פרויקט גמר הנדסת תוכנה לאינטרנט/final_project_webengineer backend/frontend/src/Auth.js"],"names":["rsa","axios","Auth","_isAuthenticated","authenticate","name","pass","cb","data","key","fetch","then","response","json","pk","rn","importKey","password","encrypt","console","log","catch","err","method","body","JSON","stringify","headers","res","register","signout","get"],"mappings":"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","sourcesContent":["import rsa from \"node-rsa\"\nimport axios from 'axios'\n\n// Mock of an authentication service\nconst Auth = {\n  _isAuthenticated: false,\n\n  authenticate(name, pass, cb) {\n    \n    var data = {name,'password' : pass}\n    var key = new rsa()\n    fetch('/get_PK_and_random')\n    .then(response => response.json())\n            .then(function(response) {\n                var pk = response.pk;\n                var rn = response.rn;\n\n\n                //encrypting the pass before sending it to the server\n                key.importKey(pk, ['public']);\n                //data['password']+rn inorder to prevenr reply attack\n                data.password = key.encrypt(data.password+rn,'base64')\n                console.log(\"data:\");\n                console.log(data);\n                console.log(\"data.password:\");\n                console.log(data.password);\n                return data\n\n                }).catch(err =>  \n                    console.log(\"get_PK_and_random error: \"+err))\n                .then((data) => \n                  fetch('/new_login',{\n                    method: 'POST',\n                    body: JSON.stringify(data),\n                    headers: {\n                      'Content-Type': 'application/json'\n                    }\n                  })\n                )\n                // .then(res => res.text())\n                // .then(res => console.log(res))\n                .then(res => res.json())\n                .then((res) => \n                  cb(res))\n                .catch(err =>  \n                  {console.log(err+';)')\n                  cb({\n                    'isAuthenticated':false,\n                })})\n    // this._isAuthenticated = true;\n    // setTimeout(\n    //   () =>\n    //     cb({\n    //       name: name\n    //     }),\n    //   100\n    // );\n  },\n\n  register(name, pass, cb) {\n    \n    var data = {name,'password' : pass}\n    var key = new rsa()\n    fetch('/get_PK_and_random')\n      .then(response => response.json())\n        .then(function(response) {\n            var pk = response.pk;\n            var rn = response.rn;\n\n\n            //encrypting the pass before sending it to the server\n            key.importKey(pk, ['public']);\n            //data['password']+rn inorder to prevenr reply attack\n            data.password = key.encrypt(data.password+rn,'base64')\n            console.log(\"data:\");\n            console.log(data);\n            console.log(\"data.password:\");\n            console.log(data.password);\n            return data\n\n            }).catch(err =>  \n                console.log(\"get_PK_and_random error: \"+err))\n            .then((data) => \n              fetch('/new_login',{\n                method: 'POST',\n                body: JSON.stringify(data),\n                headers: {\n                  'Content-Type': 'application/json'\n                }\n              })\n            )\n            // .then(res => res.text())\n            // .then(res => console.log(res))\n            .then(res => res.json())\n            .then((res) => \n              cb(res))\n            .catch(err =>  \n              {console.log(err+';)')\n              cb({\n                'isAuthenticated':false,\n            })})\n    // this._isAuthenticated = true;\n    // setTimeout(\n    //   () =>\n    //     cb({\n    //       name: name\n    //     }),\n    //   100\n    // );\n  },\n\n  signout(cb) {\n\n\n    axios.get('logOut')\n      .then(() => false)\n      .catch(err =>  \n        {console.log(err)\n        cb('Something went wrong, please try again')})\n    // this._isAuthenticated = false;\n    // setTimeout(cb, 100);\n  }\n};\n\nexport default Auth;\n"]},"metadata":{},"sourceType":"module"}