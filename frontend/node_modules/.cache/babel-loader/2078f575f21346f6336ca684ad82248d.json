{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\54646\\\\OneDrive - g.jct.ac.il\\\\\\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\\\u05E4\\u05E8\\u05D5\\u05D9\\u05E7\\u05D8 \\u05D2\\u05DE\\u05E8 \\u05D4\\u05E0\\u05D3\\u05E1\\u05EA \\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\final_project\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\54646\\\\OneDrive - g.jct.ac.il\\\\\\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\\\u05E4\\u05E8\\u05D5\\u05D9\\u05E7\\u05D8 \\u05D2\\u05DE\\u05E8 \\u05D4\\u05E0\\u05D3\\u05E1\\u05EA \\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\final_project\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"C:\\\\Users\\\\54646\\\\OneDrive - g.jct.ac.il\\\\\\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\\\u05E4\\u05E8\\u05D5\\u05D9\\u05E7\\u05D8 \\u05D2\\u05DE\\u05E8 \\u05D4\\u05E0\\u05D3\\u05E1\\u05EA \\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\final_project\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"C:\\\\Users\\\\54646\\\\OneDrive - g.jct.ac.il\\\\\\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\\\u05E4\\u05E8\\u05D5\\u05D9\\u05E7\\u05D8 \\u05D2\\u05DE\\u05E8 \\u05D4\\u05E0\\u05D3\\u05E1\\u05EA \\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\final_project\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\54646\\\\OneDrive - g.jct.ac.il\\\\\\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\\\u05E4\\u05E8\\u05D5\\u05D9\\u05E7\\u05D8 \\u05D2\\u05DE\\u05E8 \\u05D4\\u05E0\\u05D3\\u05E1\\u05EA \\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\final_project\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\54646\\\\OneDrive - g.jct.ac.il\\\\\\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\\\u05E4\\u05E8\\u05D5\\u05D9\\u05E7\\u05D8 \\u05D2\\u05DE\\u05E8 \\u05D4\\u05E0\\u05D3\\u05E1\\u05EA \\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\final_project\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\54646\\\\OneDrive - g.jct.ac.il\\\\\\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\\\u05E4\\u05E8\\u05D5\\u05D9\\u05E7\\u05D8 \\u05D2\\u05DE\\u05E8 \\u05D4\\u05E0\\u05D3\\u05E1\\u05EA \\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\final_project\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\54646\\\\OneDrive - g.jct.ac.il\\\\\\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\\\u05E4\\u05E8\\u05D5\\u05D9\\u05E7\\u05D8 \\u05D2\\u05DE\\u05E8 \\u05D4\\u05E0\\u05D3\\u05E1\\u05EA \\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\final_project\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"C:\\\\Users\\\\54646\\\\OneDrive - g.jct.ac.il\\\\\\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\\\u05E4\\u05E8\\u05D5\\u05D9\\u05E7\\u05D8 \\u05D2\\u05DE\\u05E8 \\u05D4\\u05E0\\u05D3\\u05E1\\u05EA \\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\final_project\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\54646\\\\OneDrive - g.jct.ac.il\\\\\\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\\\u05E4\\u05E8\\u05D5\\u05D9\\u05E7\\u05D8 \\u05D2\\u05DE\\u05E8 \\u05D4\\u05E0\\u05D3\\u05E1\\u05EA \\u05EA\\u05D5\\u05DB\\u05E0\\u05D4 \\u05DC\\u05D0\\u05D9\\u05E0\\u05D8\\u05E8\\u05E0\\u05D8\\\\final_project\\\\frontend\\\\src\\\\Components\\\\ProductList\\\\ProductList.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport Item from \"../Item/Item\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport \"./ProductList.css\";\nimport queryString from \"query-string\";\nimport Api from \"../../Api\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport PriceDialog from \"../PriceDialog/PriceDialog\";\nimport Paging from \"../Paging/Paging\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Select from \"@material-ui/core/Select\"; //for thr <Select/>\n\nvar sortOptions = [React.createElement(MenuItem, {\n  key: \"lh\",\n  value: \"lh\",\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 19\n  },\n  __self: this\n}, \"Sort by price: low to high\"), React.createElement(MenuItem, {\n  key: \"hl\",\n  value: \"hl\",\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 22\n  },\n  __self: this\n}, \"Sort by price: high to low\")]; // This component retrieves the products it needs to show.\n// It determines the kind of products it needs to show from query string.\n// It checks the query string on first render and on every props change.\n\nvar ProductList =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ProductList, _Component);\n\n  function ProductList(props) {\n    var _this;\n\n    _classCallCheck(this, ProductList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ProductList).call(this, props));\n\n    _this.handleSortChange = function (e) {\n      _this.updateURLAndRedirect({\n        sortValue: e.value\n      });\n    };\n\n    _this.state = {\n      unfinishedTasks: 0,\n      openPriceDialog: false,\n      wholeDataLength: null,\n      items: []\n    };\n    _this.getParamFromQS = _this.getParamFromQS.bind(_assertThisInitialized(_this));\n    _this.updateURLAndRedirect = _this.updateURLAndRedirect.bind(_assertThisInitialized(_this));\n    return _this;\n  } // Convert object to query string\n\n\n  _createClass(ProductList, [{\n    key: \"objectToQueryString\",\n    value: function objectToQueryString(params) {\n      var esc = encodeURIComponent;\n      var query = Object.keys(params).map(function (k) {\n        return esc(k) + \"=\" + esc(params[k] !== undefined ? params[k] : \"\");\n      }).join(\"&\");\n      return query;\n    } // This function is used to update the query string with new values\n    // and redirect to new URL.\n\n  }, {\n    key: \"updateURLAndRedirect\",\n    value: function updateURLAndRedirect(newValues, restartPaging) {\n      var currentQs = queryString.parse(this.props.location.search);\n\n      var newQS = _objectSpread({}, currentQs, {}, newValues);\n\n      if (restartPaging) {\n        delete newQS[\"page\"];\n      }\n\n      this.props.history.push(\"/search/?\" + this.objectToQueryString(newQS));\n    } // Extract value of certain parameter from query string.\n\n  }, {\n    key: \"getParamFromQS\",\n    value: function getParamFromQS(name) {\n      var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.props;\n      var qs = queryString.parse(props.location.search);\n\n      switch (name) {\n        case \"category\":\n          return qs.category || \"popular\";\n\n        case \"term\":\n          return qs.term || \"\";\n\n        case \"page\":\n          return qs.page || \"1\";\n\n        case \"minPrice\":\n          return qs.minPrice || \"0\";\n\n        case \"maxPrice\":\n          return qs.maxPrice || \"1000\";\n\n        case \"usePriceFilter\":\n          return qs.usePriceFilter === \"true\";\n\n        case \"sortValue\":\n          return qs.sortValue || \"lh\";\n\n        case \"itemsPerPage\":\n          return qs.itemsPerPage || \"5\";\n\n        case \"directCategoryClick\":\n          return qs.term === undefined;\n\n        default:\n          return undefined;\n      }\n    }\n  }, {\n    key: \"fetchData\",\n    value: function () {\n      var _fetchData = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var props,\n            results,\n            _args = arguments;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                props = _args.length > 0 && _args[0] !== undefined ? _args[0] : this.props;\n                this.setState(function (ps) {\n                  return {\n                    unfinishedTasks: ps.unfinishedTasks + 1\n                  };\n                }); // Make simulated request to server to get items\n\n                _context.next = 4;\n                return Api.searchItems({\n                  category: this.getParamFromQS(\"category\", props),\n                  term: this.getParamFromQS(\"term\", props),\n                  page: this.getParamFromQS(\"page\", props),\n                  itemsPerPage: this.getParamFromQS(\"itemsPerPage\", props),\n                  minPrice: this.getParamFromQS(\"minPrice\", props),\n                  maxPrice: this.getParamFromQS(\"maxPrice\", props),\n                  sortValue: this.getParamFromQS(\"sortValue\", props),\n                  usePriceFilter: this.getParamFromQS(\"usePriceFilter\", props)\n                });\n\n              case 4:\n                results = _context.sent;\n                this.setState(function (ps) {\n                  return {\n                    items: results.data,\n                    unfinishedTasks: ps.unfinishedTasks - 1,\n                    wholeDataLength: results.totalLength\n                  };\n                });\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function fetchData() {\n        return _fetchData.apply(this, arguments);\n      }\n\n      return fetchData;\n    }()\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchData();\n    }\n  }, {\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(nextProps) {\n      this.fetchData(nextProps);\n    }\n  }, {\n    key: \"getPageTitle\",\n    value: function getPageTitle() {\n      var pageTitle;\n\n      if (this.getParamFromQS(\"category\") === \"popular\") {\n        pageTitle = \"Popular products\";\n      } else if (this.getParamFromQS(\"directCategoryClick\")) {\n        pageTitle = this.getParamFromQS(\"category\");\n      } else {\n        pageTitle = \"Search results\";\n      }\n\n      return pageTitle;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        style: {\n          display: \"flex\",\n          padding: 10,\n          flexDirection: \"column\",\n          height: \"100%\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"product-list-header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"online-shop-title\",\n        style: {\n          flexGrow: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, this.getPageTitle()), React.createElement(\"div\", {\n        style: {\n          maxWidth: 500,\n          marginTop: 5,\n          display: \"flex\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, React.createElement(FormControlLabel, {\n        style: {\n          marginBottom: 5\n        },\n        control: React.createElement(Checkbox, {\n          color: \"primary\",\n          checked: this.getParamFromQS(\"usePriceFilter\"),\n          onChange: function onChange(e) {\n            _this2.updateURLAndRedirect({\n              usePriceFilter: e.target.checked\n            }, true);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160\n          },\n          __self: this\n        }),\n        label: \"Filter by price\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }), this.getParamFromQS(\"usePriceFilter\") && React.createElement(Tooltip, {\n        title: \"Click to change range\",\n        disableFocusListener: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"outlined\",\n        style: {\n          marginRight: 20\n        },\n        onClick: function onClick() {\n          _this2.setState({\n            openPriceDialog: true\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, this.getParamFromQS(\"minPrice\") + \"$ - \" + this.getParamFromQS(\"maxPrice\") + \"$\")), React.createElement(Select, {\n        style: {\n          maxWidth: 400,\n          marginBottom: 10\n        },\n        value: this.getParamFromQS(\"sortValue\"),\n        MenuProps: {\n          style: {\n            maxHeight: 500\n          }\n        },\n        onChange: function onChange(e) {\n          _this2.updateURLAndRedirect({\n            sortValue: e.target.value\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, sortOptions))), React.createElement(\"div\", {\n        style: {\n          flex: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }, this.state.unfinishedTasks !== 0 ? React.createElement(CircularProgress, {\n        className: \"circular\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }) : this.state.items.map(function (item) {\n        return React.createElement(Item, {\n          key: item.id,\n          item: item,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 212\n          },\n          __self: this\n        });\n      })), this.state.unfinishedTasks === 0 && React.createElement(Paging, {\n        getParamFromQS: this.getParamFromQS,\n        updateURLAndRedirect: this.updateURLAndRedirect,\n        wholeDataLength: this.state.wholeDataLength,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }), React.createElement(PriceDialog, {\n        open: this.state.openPriceDialog,\n        min: this.getParamFromQS(\"minPrice\"),\n        max: this.getParamFromQS(\"maxPrice\"),\n        onSave: function onSave(min, max) {\n          _this2.setState({\n            openPriceDialog: false\n          });\n\n          _this2.updateURLAndRedirect({\n            minPrice: min,\n            maxPrice: max\n          }, true);\n        },\n        onClose: function onClose() {\n          return _this2.setState({\n            openPriceDialog: false\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return ProductList;\n}(Component);\n\nexport default ProductList;","map":{"version":3,"sources":["C:/Users/54646/OneDrive - g.jct.ac.il/תוכנה לאינטרנט/פרויקט גמר הנדסת תוכנה לאינטרנט/final_project/frontend/src/Components/ProductList/ProductList.js"],"names":["React","Component","Button","Item","CircularProgress","queryString","Api","FormControlLabel","Checkbox","Tooltip","PriceDialog","Paging","MenuItem","Select","sortOptions","ProductList","props","handleSortChange","e","updateURLAndRedirect","sortValue","value","state","unfinishedTasks","openPriceDialog","wholeDataLength","items","getParamFromQS","bind","params","esc","encodeURIComponent","query","Object","keys","map","k","undefined","join","newValues","restartPaging","currentQs","parse","location","search","newQS","history","push","objectToQueryString","name","qs","category","term","page","minPrice","maxPrice","usePriceFilter","itemsPerPage","setState","ps","searchItems","results","data","totalLength","fetchData","nextProps","pageTitle","display","padding","flexDirection","height","flexGrow","getPageTitle","maxWidth","marginTop","marginBottom","target","checked","marginRight","style","maxHeight","flex","item","id","min","max"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport Item from \"../Item/Item\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport \"./ProductList.css\";\nimport queryString from \"query-string\";\nimport Api from \"../../Api\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport PriceDialog from \"../PriceDialog/PriceDialog\";\nimport Paging from \"../Paging/Paging\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Select from \"@material-ui/core/Select\";\n\n\n//for thr <Select/>\nconst sortOptions = [\n  <MenuItem key={\"lh\"} value={\"lh\"}>\n    Sort by price: low to high\n  </MenuItem>,\n  <MenuItem key={\"hl\"} value={\"hl\"}>\n    Sort by price: high to low\n  </MenuItem>\n];\n\n// This component retrieves the products it needs to show.\n// It determines the kind of products it needs to show from query string.\n// It checks the query string on first render and on every props change.\nclass ProductList extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      unfinishedTasks: 0,\n      openPriceDialog: false,\n      wholeDataLength: null,\n      items: []\n    };\n\n    this.getParamFromQS = this.getParamFromQS.bind(this);\n    this.updateURLAndRedirect = this.updateURLAndRedirect.bind(this);\n  }\n\n  // Convert object to query string\n  objectToQueryString(params) {\n    var esc = encodeURIComponent;\n    var query = Object.keys(params)\n      .map(k => esc(k) + \"=\" + esc(params[k] !== undefined ? params[k] : \"\"))\n      .join(\"&\");\n\n    return query;\n  }\n\n  // This function is used to update the query string with new values\n  // and redirect to new URL.\n  updateURLAndRedirect(newValues, restartPaging) {\n    let currentQs = queryString.parse(this.props.location.search);\n    let newQS = { ...currentQs, ...newValues };\n\n    if (restartPaging) {\n      delete newQS[\"page\"];\n    }\n\n    this.props.history.push(\"/search/?\" + this.objectToQueryString(newQS));\n  }\n\n  // Extract value of certain parameter from query string.\n  getParamFromQS(name, props = this.props) {\n    let qs = queryString.parse(props.location.search);\n\n    switch (name) {\n      case \"category\":\n        return qs.category || \"popular\";\n      case \"term\":\n        return qs.term || \"\";\n      case \"page\":\n        return qs.page || \"1\";\n      case \"minPrice\":\n        return qs.minPrice || \"0\";\n      case \"maxPrice\":\n        return qs.maxPrice || \"1000\";\n      case \"usePriceFilter\":\n        return qs.usePriceFilter === \"true\";\n      case \"sortValue\":\n        return qs.sortValue || \"lh\";\n      case \"itemsPerPage\":\n        return qs.itemsPerPage || \"5\";\n      case \"directCategoryClick\":\n        return qs.term === undefined;\n      default:\n        return undefined;\n    }\n  }\n\n  async fetchData(props = this.props) {\n    this.setState(ps => ({ unfinishedTasks: ps.unfinishedTasks + 1 }));\n\n    // Make simulated request to server to get items\n    let results = await Api.searchItems({\n      category: this.getParamFromQS(\"category\", props),\n      term: this.getParamFromQS(\"term\", props),\n      page: this.getParamFromQS(\"page\", props),\n      itemsPerPage: this.getParamFromQS(\"itemsPerPage\", props),\n      minPrice: this.getParamFromQS(\"minPrice\", props),\n      maxPrice: this.getParamFromQS(\"maxPrice\", props),\n      sortValue: this.getParamFromQS(\"sortValue\", props),\n      usePriceFilter: this.getParamFromQS(\"usePriceFilter\", props)\n    });\n\n    this.setState(ps => ({\n      items: results.data,\n      unfinishedTasks: ps.unfinishedTasks - 1,\n      wholeDataLength: results.totalLength\n    }));\n  }\n\n  componentDidMount() {\n    this.fetchData();\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    this.fetchData(nextProps);\n  }\n\n  handleSortChange = e => {\n    this.updateURLAndRedirect({ sortValue: e.value });\n  };\n\n  getPageTitle() {\n    let pageTitle;\n    if (this.getParamFromQS(\"category\") === \"popular\") {\n      pageTitle = \"Popular products\";\n    } else if (this.getParamFromQS(\"directCategoryClick\")) {\n      pageTitle = this.getParamFromQS(\"category\");\n    } else {\n      pageTitle = \"Search results\";\n    }\n    return pageTitle;\n  }\n\n  render() {\n    return (\n      <div\n        style={{\n          display: \"flex\",\n          padding: 10,\n          flexDirection: \"column\",\n          height: \"100%\"\n        }}\n      >\n        <div className=\"product-list-header\">\n          <div className=\"online-shop-title\" style={{ flexGrow: 1 }}>\n            {this.getPageTitle()}\n          </div>\n          <div style={{ maxWidth: 500, marginTop: 5, display: \"flex\" }}>\n            <FormControlLabel\n              style={{ marginBottom: 5 }}\n              control={\n                <Checkbox\n                  color=\"primary\"\n                  checked={this.getParamFromQS(\"usePriceFilter\")}\n                  onChange={e => {\n                    this.updateURLAndRedirect(\n                      { usePriceFilter: e.target.checked },\n                      true\n                    );\n                  }}\n                />\n              }\n              label=\"Filter by price\"\n            />\n            {this.getParamFromQS(\"usePriceFilter\") && (\n              <Tooltip title=\"Click to change range\" disableFocusListener>\n                <Button\n                  variant=\"outlined\"\n                  style={{ marginRight: 20 }}\n                  onClick={() => {\n                    this.setState({\n                      openPriceDialog: true\n                    });\n                  }}\n                >\n                  {this.getParamFromQS(\"minPrice\") +\n                    \"$ - \" +\n                    this.getParamFromQS(\"maxPrice\") +\n                    \"$\"}\n                </Button>\n              </Tooltip>\n            )}\n            <Select\n              style={{ maxWidth: 400, marginBottom: 10 }}\n              value={this.getParamFromQS(\"sortValue\")}\n              MenuProps={{\n                style: {\n                  maxHeight: 500\n                }\n              }}\n              onChange={e => {\n                this.updateURLAndRedirect({ sortValue: e.target.value });\n              }}\n            >\n              {sortOptions}\n            </Select>\n          </div>\n        </div>\n        <div style={{ flex: 1 }}>\n          {this.state.unfinishedTasks !== 0 ? (\n            <CircularProgress className=\"circular\" />\n          ) : (\n            this.state.items.map(item => {\n              return <Item key={item.id} item={item} />;\n            })\n          )}\n        </div>\n        {this.state.unfinishedTasks === 0 && (\n          <Paging\n            getParamFromQS={this.getParamFromQS}\n            updateURLAndRedirect={this.updateURLAndRedirect}\n            wholeDataLength={this.state.wholeDataLength}\n          />\n        )}\n        <PriceDialog\n          open={this.state.openPriceDialog}\n          min={this.getParamFromQS(\"minPrice\")}\n          max={this.getParamFromQS(\"maxPrice\")}\n          onSave={(min, max) => {\n            this.setState({ openPriceDialog: false });\n            this.updateURLAndRedirect({ minPrice: min, maxPrice: max }, true);\n          }}\n          onClose={() =>\n            this.setState({\n              openPriceDialog: false\n            })\n          }\n        />\n      </div>\n    );\n  }\n}\n\nexport default ProductList;\n"]},"metadata":{},"sourceType":"module"}